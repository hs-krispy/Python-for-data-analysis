## 서울시 전월세가 정보

- 자치구, 법정동, 건물명, 임대건물명, 전월세구분, 보증금, 임대료, 계약년도 등의 전월세 정보가 제공
- csv 파일의 형태가 column 하나로 구성되어 있었음
  - 엑셀의 텍스트 나누기를 통해 컬럼에 따른 데이터를 분류

```python
import pandas as pd

pd.set_option('display.max_rows', 100)
pd.set_option('display.max_columns', 100)
pd.set_option('display.width', 100)
              
data = pd.read_csv("C:/Users/0864h/Downloads/서울특별시_전월세가_정보_2020/서울특별시_전월세가_정보_2020.csv", encoding="CP949")

data.info()
```

<img src="https://user-images.githubusercontent.com/58063806/126503714-a2e63128-760f-4372-9278-c0ea423d9d44.png" width=30% />

- 본번, 부번, 건물명, 층 데이터에 15만개 정도의 결측치 존재
- 임대건물코드 ~ 계약일자 테이터에 3천개 정도의 결측치 존재
- 건축년도에 만개 정도의 결측치 존재
- Unnamed 22, 23 컬럼 확인할 필요 있음

```python
data[~data["Unnamed: 22"].isnull()]
```

- 결측치가 아닌 데이터의 개수가 확실히 적은 것으로 보아 해당 데이터에 이상이 있다고 판단
- 정상의 데이터와 비교했을 때 건물명 컬럼에 대한 데이터가 층에 있었고 층 컬럼 이후의 데이터들은 2칸씩 밀린 상태로 존재했음 

<img src="https://user-images.githubusercontent.com/58063806/126504440-375c27c7-c9d6-4da0-9f14-6f438b294b1d.png" width=60% />

```python
data.loc[~data["Unnamed: 22"].isnull(), "건물명"] = data.loc[~data["Unnamed: 22"].isnull(), "층"].values
data.loc[~data["Unnamed: 22"].isnull(), "층":"건축년도"] = data.loc[~data
                                                               ["Unnamed: 22"].isnull(), "임대건물명":].values
```

- 데이터 재배치

```python
cols = ["임대면적", "보증금", "임대료"]
data[cols].describe()
```

- 전체 데이터에 대해 임대면적, 보증금, 임대료에 대한 통계량을 확인

<img src="https://user-images.githubusercontent.com/58063806/126506198-1a97949d-ef86-4df1-8668-3d5d51b61634.png" width=50% />

```python
print(data["전월세구분"].unique())
# array(['준전세', '준월세', '전세', '월세', nan], dtype=object)
print(data["전월세구분"].describe())
# count     514763
# unique         4
# top           전세
# freq      310100
```

- 전월세구분 데이터는 결측치를 제외하고 준전세, 준월세, 전세, 월세 4가지로 구성
- 60% 정도의 비율로 전세의 비중이 높은 것을 알 수 있음

```python
refacted_data = data.pivot_table(["임대료", "보증금"], index=["자치구명", "법정동명", "전월세구분"], 
                                 aggfunc=["mean", "max", "min", "count"])
refacted_data
```

- 각 구의 동, 전월세 별로 보증금과 임대료의 평균, 최대, 최소, 빈도를 추출

<img src="https://user-images.githubusercontent.com/58063806/126520344-780d7eb1-34da-4102-98c5-8e756c5c3115.png" width=80%/>

```python
def show(gu, Type):
    df = refacted_data[(refacted_data.reset_index(["법정동명", "전월세구분"]).index == gu)]
    df = df.reset_index("전월세구분")[df.reset_index("전월세구분")["전월세구분"].isin([Type])]
    return df

df = show("강남구", "월세")
df
```

- EX) 강남구에 속한 각 동별 월세의 보증금, 임대료 평균, 최대, 최소, 빈도

<img src="https://user-images.githubusercontent.com/58063806/126521198-fb5952e7-72e5-4b1f-ac6b-36c86409b6bb.png" width=80%/>

```python
from matplotlib import patches

plt.rcParams.update({'font.size': 20})
fig = df["mean"].plot.bar(grid=True, title="월세", figsize=(25, 15), rot=45)
for bar in fig.patches:
    fig.annotate(round(bar.get_height()), 
                       (bar.get_x() + bar.get_width() / 2, 
                        bar.get_height()), ha='center', va='center',
                       size=20, xytext=(-1, 8),
                       textcoords='offset points')
```

- EX) 강남구에 속한 각 동별 월세에 해당하는 보증금, 임대료 평균 시각화

<img src="https://user-images.githubusercontent.com/58063806/126522133-2fb3d20d-9ee6-4b10-9dc8-697c6c005411.png" width=80% />